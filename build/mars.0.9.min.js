var Class=(function(){var _slice=[].slice;function create(property){if(!property.initialize){property.initialize=function(){}}var _class=function(){if(!this.__uninitialize&&typeof this.initialize=="function"){return this.initialize.apply(this,arguments)}};var args=[];args=_slice.call(arguments,1);var key=null,parent_property=null;if(typeof args[0]=="function"){var parent=args[0];parent.prototype.__uninitialize=true;parent_property=new parent();parent.prototype.__uninitialize=false;_class.prototype=parent_property;_class.prototype._super=parent.prototype;args=args.slice(1)}add_methods(_class,property);for(var i=0;i<args.length;i++){var arg=args[i];if(typeof arg=="object"){for(key in arg){if(typeof _class.prototype[key]=="undefined"){_class.prototype[key]=arg[key]}}}}_class.prototype.constructor=_class;return _class}function add_methods(target,properties){for(var key in properties){var property=properties[key];add_method(target,key,property)}}function add_method(_class,key,current_fn){if(_class.prototype._super&&typeof _class.prototype._super[key]=="function"){_class.prototype[key]=(function(k,v){return function(){var tmp=this._super;this._super=tmp[k];var result=v.apply(this,arguments);this._super=tmp;return result}})(key,current_fn)}else{_class.prototype[key]=current_fn}}function instance(className){if(typeof className=="string"){className=eval(className)}if(typeof className==="undefined"){throw"illegal class name"}if(typeof className._instance==="undefined"){className._instance=new className()}return className._instance}function extend(class_name){var args=[].slice.call(arguments,1);for(var property in args){var static_property=args[property];for(var key in static_property){class_name[key]=static_property[key]}}return class_name}return{create:create,add_method:add_method,add_methods:add_methods,instance:instance,extend:extend}})();var Mars={modules:{}};Class.extend(Mars,(function(){function g(j,i){if(typeof i=="undefined"){return Mars.modules[j]}if(Mars.modules[j]){throw"module already defined"}Mars.modules[j]=i;return Mars}function c(k){var j=Class.create({initialize:function(l){this.m=l},each:function(m,l){try{this._each(m,l)}catch(n){if(n!="break"){throw n}}return this.m}},Mars.module("enumberable"));var i=k instanceof Array?function(n,m){for(var l=0;l<this.m.length;l++){n.call(m,this.m[l],l)}}:function(n,m){for(var l in this.m){n.call(m,this.m[l],l)}};Class.add_method(j,"_each",i);return new j(k)}function e(k,j,i){return c(k).each(j,i).m}function f(l){var k="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz".split("");if(!this.__random_list){this.__random_list={}}if(!l){l=8}var m="";for(var j=0;j<l;j++){m+=k[Math.floor(Math.random()*k.length)]}if(this.__random_list[m]>-1){return f(l)}this.__random_list[m]=1;return m}function b(k){var l={};for(var i in k){var j=k[i];if(typeof j=="object"){if(typeof j.slice=="function"){l[i]=arguments.callee(j)}else{l[i]=h(j)}}else{l[i]=k[i]}}return l}function h(l){var m=[];for(var k=0;k<l.length;k++){var j=l[k];if(typeof j=="object"){if(typeof item.slice=="function"){m[k]=arguments.callee(item)}else{m[k]=h(item)}}else{m[k]=j}}return m}function a(i){if(typeof i=="object"){if(i instanceof Array){return b(i)}else{return h(i)}}return i}function d(j,i){if(j.__proxy){return j.__proxy}var k=function(){return j.apply(i,arguments)};j.__proxy=k;return k}return{module:g,_:c,each:e,random_string:f,deep_copy:a,proxy:d,}})());Mars.module("enumberable",(function(){function b(d,c){try{this._each(d,c)}catch(f){if(f!="break"){throw f}}return this}function a(d,c){var e=[];this.each(function(g,f){e.push(d.call(c,g,f))});return e}return{each:b,collect:a,map:a}})());Mars.module("observer",(function(){function d(){if(!this.__publish_handler){this.__publish_handler={};this.__published={}}}function c(h,g,f){this.__init_observer();var e=this;if(!f&&!this._notify_sync){setTimeout(function(){e.notify(h,g,true)},0);return}var i=this.__publish_handler[h];Mars._(i).each(function(j){var k=Mars.deep_copy(g);j(k)});setTimeout(function(){e.__published[h]=Mars.deep_copy(g)},1);return this}function a(g,f){this.__init_observer();if(typeof f=="undefined"){this.__publish_handler[g]=[];return}var e=this.__publish_handler[g];Mars._(e).each(function(i,h){if(i===f){this.__publish_handler[g].splice(h,1);throw"break"}},this);return this}function b(g,f,e){this.__init_observer();if(e&&this.__published[g]){f(this.__published[g]);return}this.__publish_handler[g]=this.__publish_handler[g]||[];this.__publish_handler[g].push(f);return this}return{__init_observer:d,notify:c,add_observer:b,remove_observer:a,bind:b,unbind:a,trigger:c,on:b,off:a}})());